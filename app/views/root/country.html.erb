<% page_title @country.name %>

<%if @countries.present? %>
  <div class="countries">
    <ul>
      <% @countries.each_with_index do |country, idx_country| %>
        <li><%= link_to country.name, country_path(country), style: params[:id] == country.slug ? "font-weight: bold;" : "" %></li>
      <% end %>
    </ul>
  </div>
<% end %>

<div class="country-profile">
  <ul>
    <li>
      <%= image_tag(@country.flag_image.url(:thumb)) if @country.flag_image.exists? %>
    </li>
    <li><strong><%= t('.leader') %>:</strong> <%= @country.leader %></li>
    <li>
      <%= image_tag(@country.leader_image.url(:thumb)) if @country.leader_image.exists? %>
    </li>
    <li><strong><%= t('.area') %>:</strong> <%= "#{number_with_delimiter(@country.area)} km<sup>2</sup>".html_safe if @country.area.present? %></li>
    <li><strong><%= t('.population') %>:</strong> <%= number_with_delimiter(@country.population) %></li>
    <li><strong><%= t('.gdp') %>:</strong> <%= "$#{number_with_delimiter(@country.gdp)}" if @country.gdp.present? %></li>
    <li>
      <% heading = t('.ti_link') %>
      <% if @country.ti_url.present? %>
        <% heading = link_to(t('.ti_link'), @country.ti_url, title: t('.ti_title'), target: :blank) %>
      <% end %>
      <strong><%= heading %>:</strong>
      <%= @country.ti_index_score %>
      <% if @country.ti_index_rank.present? %>
        <%= "(#{t('shared.common.rank')}: #{@country.ti_index_rank}/180)" %>
      <% end %>
    </li>
    <li>
      <% heading = t('.freedom_house_link') %>
      <% if @country.freedom_house_url.present? %>
        <% heading = link_to(t('.freedom_house_link'), @country.freedom_house_url, title: t('.freedom_house_title'), target: :blank) %>
      <% end %>
      <strong><%= heading %>:</strong> <%= @country.freedom_house_index_value %>
    </li>
  </ul>

  <% if @country.lat.present? && @country.lon.present? %>
    <div id="country_map" data-lat="<%= @country.lat %>" data-lon="<%= @country.lon %>" data-map-zoom-level="<%= @country.map_zoom_level %>"></div>

  <% end %>
</div>



<% if @stories.present? %>
  <div class="stories">
    <% @stories.each do |story| %>
      <div class="story-item">
        <h3><%= story.title %></h3>
        <div class="story-date">
          <%= story.time_period.label %>
        </div>
        <% if story.image.exists? %>
          <div class="story-image">
            <%= image_tag(story.image.url(:medium)) %>
          </div>
        <% end %>
        <div class="story-text">
          <%= simple_format story.content %>
        </div>
        <% if story.link.present? %>
          <%= link_to t('.view_story'), story.link, target: :blank, class: 'btn btn-default btn-small' %>
        <% end %>
      </div>
    <% end %>
  </div>
<% else %>
  <p class="alert alert-warning">
    <%= t('.no_stories') %>
  </p>
<% end %>
